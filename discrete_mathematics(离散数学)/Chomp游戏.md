## Chomp游戏专题

&emsp;&emsp;在课堂上老师带领我们玩了这样一个有趣的游戏：

&emsp;&emsp;游戏规则：我们现在有一个 $m\times n$ 的表格，每个格子里都有一块饼干，并且表格最左上角格子里的饼干是有毒的。现在两个玩家轮流拿走格子里的饼干，要求是每当拿走某个格子里的饼干时，同时得拿走该格子右方和下方的所有的饼干，最后拿到有毒饼干的玩家会输掉游戏。

&emsp;&emsp;求该游戏的必胜策略(提示：该游戏先手必胜)。

&emsp;&emsp;我们有这样的定理：如果一个游戏的全部信息是公开的，没有随机的要素，能够在有限步骤内完成，并且没有平局，那么该游戏必有必胜策略，要么先手必胜，要么后手必胜。

&emsp;&emsp;我们先来证明一下这个游戏必然有先手必胜策略：

&emsp;&emsp;假设先手玩家第一步拿走了最右下角格子里的饼干，那么先手玩家要么进入必胜状态，要么进入必败状态。若该玩家进入必胜状态，那么先手必胜成立，若该玩家进入必败状态，则后手玩家进入必胜状态，这局不算重来一局，先手玩家的第一步模仿上一局后手玩家的第一步来走，则可进入必胜状态，那么先手必胜也成立。(实在是有点耍赖)

&emsp;&emsp;**我们先来考虑一些比较简单的情形**(我们以水平向右为 $x$ 轴，竖直向下为 $y$ 轴，每个格子占据一个整点，其中有毒的饼干占据的位置是(1,1))：

&emsp;&emsp;一、 $3\times 3$ 的表格

&emsp;&emsp;先手可以直接取走(2,2)位置的饼干，这样表格里就只剩下了 $y$ 坐标为1的饼干和 $x$ 坐标为1的饼干，接下来无论后手怎么走，先手都只需要模仿后手的走法并且对称着走即可，比如后手取走(1,3)，那么先手就取走(3,1)，这样有毒饼干的竖直下方的饼干和水平右方的饼干会被逐渐取走，因为先手一直在模仿后手的走法，所以最后一块无毒的饼干一定是被先手取走的，所以后手就会失败。

&emsp;&emsp;实际上，对于任何一个 $n\times n$ 的格子，先手都可以直接取走(2,2)位置的饼干，然后模仿后手的走法来获得胜利。

&emsp;&emsp;二、 $2\times n$ 的表格

&emsp;&emsp;先手直接取走( $n$ ,2)位置的饼干，也就是最右下角的饼干，接下来，如果后手取走(2, $p$ )位置的饼干，先手就取走(1, $p+1$ )位置的饼干；如果后手取走(1, $q$ )位置的饼干，先手就取走(2, $q-1$ )位置的饼干；循环往复，先手就能取得最后的胜利。

&emsp;&emsp;这是为什么呢？其实当我们取走了最右下角的饼干之后，第一行除了有毒的饼干之外还剩下 $n-1$ 块饼干，第二行也还剩下 $n-1$ 块饼干，这其实也形成了一种对称，(2, $q$ )位置的饼干同(1, $q+1$ )位置的饼干(也就是它右上方的饼干)是对称的，不论后手怎么取，先手只需要取走对称位置的饼干即可，这样最后一块无毒的饼干一定是被先手取走的，所以后手就会失败。

&emsp;&emsp;**接下来我们思考这样一个问题：** 对于一个 $m\times n$ 的表格，在游戏过程中最多能出现多少种不同的表格状态？(不妨令 $m\leqslant n$ )

&emsp;&emsp;我们设在游戏过程中从下往上数第 $i$ 行还剩的饼干数目为 $x_i(1\leqslant i\leqslant m$ )，显然在游戏最开始时有

$$\begin{align\*}
x_1=x_2=...=x_m=n
\end{align\*}$$

&emsp;&emsp;因为游戏规则规定的是取走某个格子的饼干时要同时取走该格子下方和右方所有格子里的饼干，也就是说，在游戏过程中，一定会有 $x_i\leqslant x_{i+1}$ ，就是上方的行的饼干剩余数一定大于等于下方的行的饼干剩余数，换句话说，我们有

$$\begin{align\*}
0\leqslant x_1\leqslant x_2\leqslant ...\leqslant x_m\leqslant n
\end{align\*}$$

&emsp;&emsp;其实就是求解不减序列 $x_1x_2...x_m$ 有多少种可能，我们只需要做下面的处理：

$$\begin{align\*}
令:y_1=x_1,y_i=x_i-x_{i-1}(2\leqslant i\leqslant m),y_{m+1}=n-x_m\\
累加可得:
y_1+y_2+y_3+...+y_{m+1}=n\\
问题就等价于求该方程的非负整数解\\
也就是\binom{m+n}{m}\\
\end{align\*}$$

&emsp;&emsp;后文会提到我们为什么需要计算游戏过程中的状态数。因为一旦对手只差一步就能进入必胜状态，那么该状态就是必败状态。同理，如果对手在面对某个状态而不得不走到必败状态，那么该状态就是必胜状态。所以对于一些比较简单的情况，我们可以列举所有的状态，然后区分必败与必胜状态。

&emsp;&emsp;接下来，我们以 $3\times 4$ 的表格为例，按照上述模式，列出所有的状态(共35种状态)

| 444  | 431  | 400  | 320  | 211  |
| ---- | ---- | ---- | ---- | ---- |
| 443  | 430  | 333  | 311  | 210  |
| 442  | 422  | 332  | 310  | 200  |
| 441  | 421  | 331  | 300  | 111  |
| 440  | 420  | 330  | 222  | 110  |
| 433  | 411  | 322  | 221  | 100  |
| 432  | 410  | 321  | 220  | 000  |

&emsp;&emsp;显然000为必败状态(因为到达000时已经输掉了)。

&emsp;&emsp;100为必胜状态(因为对手不得不再拿走一块饼干而达到000，对手输了)

&emsp;&emsp;对于其他的状态，只要那些状态能够一步走到必胜状态，那么这些状态就是必败的。比如说我走完后的状态是110，那么对手必然会抓住机会将状态变为100，那么在轮到我走我就一定会输，所以110为必败状态。111也是同理，如果我走完后的状态是111，那么对手必然会抓住机会将状态变为100，那么在轮到我走我就一定会输，所以110为必败状态。200也是同理。

&emsp;&emsp;但是当我走完状态为210时，对手可以一步走到200，但此时对手必败，对手也可以一步走到110，但是对手还是会必败，所以210对于我来说就是必胜状态。也就是说，若该状态的任意下一个状态永远都是必败状态，那么该状态就是必胜状态。

&emsp;&emsp;那么我们就可以获得如下的表格

| 444(胜) | 431(败) | 400(败) | 320(胜) | 211(败) |
| ------- | ------- | ------- | ------- | ------- |
| 443(败) | 430(胜) | 333(败) | 311(胜) | 210(胜) |
| 442(败) | 422(胜) | 332(败) | 310(败) | 200(败) |
| 441(败) | 421(败) | 331(败) | 300(败) | 111(败) |
| 440(败) | 420(败) | 330(败) | 222(败) | 110(败) |
| 433(败) | 411(败) | 322(败) | 221(胜) | 100(胜) |
| 432(败) | 410(败) | 321(败) | 220(败) | 000(败) |

&emsp;&emsp;先手在面对状态444时，只需要走到422，就一定会胜利。而其他的必胜状态是无法由444一步走到的，所以先手走也只能走到422来获得胜利。
