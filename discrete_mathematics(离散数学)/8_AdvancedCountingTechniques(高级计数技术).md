# 第八章 高级计数原理

## 递推关系的应用

&emsp;&emsp;我们都知道斐波那契数列，它具有下面的递推关系(为了省事，我们就不在研究那群不死的兔子了)：

$$\begin{align\*}
f_n=f_{n-1}+f_{n+2}(n\geqslant3),f_1=1,f_2=2
\end{align\*}$$

&emsp;&emsp;研究的重点以及难点就在于如何找到正确的递推关系，下面我们来举几个例子：

&emsp;&emsp;**例一：** 考虑 $n$ 位长的由0和1组成的二元字符串， $a_n$ 表示不含有连续两个0(或者说任何一个二长片段都不能是“00”)的 $n$ 长字符串的个数，试求出 $a_n$ 的递推关系。

> 求递推关系的关键在于考虑该项的前几项，而不是从第一项开始考虑。

&emsp;&emsp;**解：** 我们对 $n$ 长字符串做如下的分类：

&emsp;&emsp;1)该字符串以1开头，则剩余的 $n-1$ 位字符串不会出现两个连续的0，即有 $a_{n-1}$ 个。

&emsp;&emsp;2)该字符串以0开头，则第二位必然是1，并且剩余的 $n-2$ 位字符串里不会出现两个连续的0，即有 $a_{n-2}$  个。

&emsp;&emsp;所以我们获得了如下的递推关系：

$$\begin{align\*}
a_n=a_{n-1}+a_{n-2}
\end{align\*}$$

&emsp;&emsp;**例二：** 如果题目改成不含连续的三个0，递推关系又该是什么呢？

&emsp;&emsp;**解：** 我们对 $n$ 长字符串做如下的分类：

&emsp;&emsp;1)该字符串以1开头，则剩余的 $n-1$ 位字符串不会出现三个连续的0，即有 $a_{n-1}$ 个。

&emsp;&emsp;2)该字符串以0开头，那么又要分为两种情况，若第二位为0，那么第三位必然只能是1，而且剩余的 $n-3$ 位字符串不会出现连续的三个0，即有 $a_{n-2}$ 个；若第二位为1，那么第三位是0是1无所谓，只需要剩余的 $n-2$ 位字符串不会出现连续的三个0即可，即有 $a_{n-3}$ 个。

&emsp;&emsp;所以我们获得了如下的递推关系：

$$\begin{align\*}
a_n=a_{n-1}+a_{n-2}+a_{n-3}(n\geqslant4)
\end{align\*}$$

&emsp;&emsp;**例三：** 如果是不含连续的t个0呢？

&emsp;&emsp;同理可得：

$$\begin{align\*}
a_n=a_{n-1}+a_{n-2}+...+a_{n-t}(n\geqslant t+1)
\end{align\*}$$

&emsp;&emsp;**变式：** 如果要求该字符串同时不含连续的三个0和连续的三个1呢？

> 我们前几个例子给出的都是对第 $n$ 项进行分类，实际上我们也可以从第 $n-1$ 项或者第 $n-2$ 项开始，来将其转化为第 $n$ 项。

&emsp;&emsp;**解：** 我们考虑符合题意的 $n-1$ 长的字符串，如果我们在该字符串的开头添加0或1，它就变成了 $n$ 长的字符串，这样我们似乎是获得了 $2a_{n-1}$ 个符合题意的字符串，但是随即我们就发现，对于开头是00的 $n-1$ 长的字符串我们不能在开头加0，对于开头是11的 $n-1$ 长的字符串我们不能在开头加1，而开头是00的 $n-1$ 长的字符串剩余的 $n-3$ 位必然是以数字1开头的符合题意的字符串，而开头是11的 $n-1$ 长的字符串剩余的 $n-3$ 位必然是以数字0开头的符合题意的字符串，那么两种情况加起来既包含了数字1开头又包含了数字0开头，所以需要去掉的个数总共是 $a_{n-3}$ 个。所以我们有如下的递推：

$$\begin{align\*}
a_n=2a_{n-1}-a_{n-3}(n\geqslant4)
\end{align\*}$$

&emsp;&emsp;**另外一种方法：** 我们考虑这样一个双射，它把n长的二元字符串(对于双射的概念，详见第二章)

$$\begin{align\*}
x_1x_2...x_n(x_i=0或1，1\leqslant i\leqslant n)
\end{align\*}$$

&emsp;&emsp;转变为一个序对 $(x_1,\delta)$ ，其中：

$$\begin{align\*}
\delta=(x_1+x_2,x_2+x_3,...,x_{n-1}+x_{n})(mod\;2)\\
\end{align\*}$$

&emsp;&emsp;我们有原来的字符串，我们就能够计算出该序对，同样的，我们有了序对，就能恢复出原来的字符串，不难理解这是一个双射。

&emsp;&emsp;我们发现，如果有连续的三个0或者连续的三个1，那么 $\delta$ 中就会出现连续的两个0，所以我们只需要求出不含连续的两个0的 $\delta$  序列即可，对于原来是 $n$ 长的字符串，它会产生 $n-1$ 长的 $\delta$ 序列，我们令 $b_n$ 来表示 $n$ 长的不含连续两个0的 $\delta$ 序列，根据我们前面的例子，我们会有

$$\begin{align\*}
b_{n-1}=b_{n-2}+b_{n-3}(n\geqslant 4)
\end{align\*}$$

&emsp;&emsp;由于我们双射产生的序对是 $(x_1,\delta)$ ，那么对于任意一个合适的 $\delta$ 序列，我们的 $x_1$ 为0或者为1都可以产生符合题意的原字符串，也就是说，有

$$\begin{align\*}
a_n=2b_{n-1}
\end{align\*}$$

&emsp;&emsp;我们带回之前的递推，则有：

$$\begin{align\*}
a_n=a_{n-1}+a_{n-2}(n\geqslant 3)\\
\end{align\*}$$

&emsp;&emsp;**注意：** 有没有很惊讶，对于同一个数列，我们竟然能写出两种不同的递推关系，而且这两种递推关系都是正确的！那么实际上这是一件很容易发生的事情，我们有时候甚至能写出不止两种，但是尽管递推关系不同，最后求出的通项公式一定是相同的，这一点在后面我们还会提到。
